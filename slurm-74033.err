[rank: 2] Seed set to 42
[rank: 0] Seed set to 42
[rank: 3] Seed set to 42
[rank: 1] Seed set to 42
Initializing distributed: GLOBAL_RANK: 2, MEMBER: 3/4
Initializing distributed: GLOBAL_RANK: 0, MEMBER: 1/4
Initializing distributed: GLOBAL_RANK: 1, MEMBER: 2/4
Initializing distributed: GLOBAL_RANK: 3, MEMBER: 4/4
----------------------------------------------------------------------------------------------------
distributed_backend=nccl
All distributed processes registered. Starting with 4 processes
----------------------------------------------------------------------------------------------------

Using cache found in /data/home/akashsharma02/.cache/torch/hub/pytorch_vision_v0.10.0
Using cache found in /data/home/akashsharma02/.cache/torch/hub/pytorch_vision_v0.10.0
Using cache found in /data/home/akashsharma02/.cache/torch/hub/pytorch_vision_v0.10.0
Using cache found in /data/home/akashsharma02/.cache/torch/hub/pytorch_vision_v0.10.0
  0%|          | 0/500 [00:00<?, ?it/s]wandb: Currently logged in as: akashsharma. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.16.2
wandb: Run data is saved locally in /opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/wandb/run-20240129_063844-c6csj9az
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run 2024.01.29-06-38_tdex-run1
wandb: â­ï¸ View project at https://wandb.ai/akashsharma/tactile_dexterity
wandb: ðŸš€ View run at https://wandb.ai/akashsharma/tactile_dexterity/runs/c6csj9az
  0%|          | 0/500 [00:00<?, ?it/s]Epoch 0, Train loss: 1.66599, Best loss: inf:   0%|          | 0/500 [04:29<?, ?it/s]Epoch 0, Train loss: 1.66599, Best loss: inf:   0%|          | 1/500 [04:29<37:21:40, 269.54s/it]Error executing job with overrides: ['experiment=tdex-run1']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 82, in <module>
    main()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 78, in main
    train(fabric, cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 45, in train
    if logger and epoch % cfg.log_frequency == 0:
UnboundLocalError: local variable 'logger' referenced before assignment
  0%|          | 0/500 [00:00<?, ?it/s]Epoch 0, Train loss: 1.66453, Best loss: inf:   0%|          | 0/500 [04:29<?, ?it/s]Epoch 0, Train loss: 1.66453, Best loss: inf:   0%|          | 1/500 [04:29<37:24:28, 269.88s/it]Error executing job with overrides: ['experiment=tdex-run1']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 82, in <module>
    main()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 78, in main
    train(fabric, cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 45, in train
    if logger and epoch % cfg.log_frequency == 0:
UnboundLocalError: local variable 'logger' referenced before assignment
  0%|          | 0/500 [00:00<?, ?it/s]Epoch 0, Train loss: 1.66462, Best loss: inf:   0%|          | 0/500 [04:29<?, ?it/s]Epoch 0, Train loss: 1.66462, Best loss: inf:   0%|          | 1/500 [04:29<37:24:32, 269.89s/it]Error executing job with overrides: ['experiment=tdex-run1']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 82, in <module>
    main()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 78, in main
    train(fabric, cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 45, in train
    if logger and epoch % cfg.log_frequency == 0:
UnboundLocalError: local variable 'logger' referenced before assignment
Epoch 0, Train loss: 1.66599, Best loss: inf:   0%|          | 1/500 [04:30<37:33:02, 270.91s/it]
Epoch 0, Train loss: 1.66453, Best loss: inf:   0%|          | 1/500 [04:31<37:36:55, 271.37s/it]
Epoch 0, Train loss: 1.66462, Best loss: inf:   0%|          | 1/500 [04:31<37:37:04, 271.39s/it]
Epoch 0, Train loss: 1.66327, Best loss: inf:   0%|          | 0/500 [04:29<?, ?it/s]Epoch 0, Train loss: 1.66327, Best loss: inf:   0%|          | 1/500 [04:29<37:24:39, 269.90s/it][E ProcessGroupGloo.cpp:2802] [Rank 0]: Rank 1 failed to pass monitoredBarrier in 1800000 ms
[E ProcessGroupGloo.cpp:2802] [Rank 0]: Rank 2 failed to pass monitoredBarrier in 1800000 ms
[E ProcessGroupGloo.cpp:2802] [Rank 0]: Rank 3 failed to pass monitoredBarrier in 1800000 ms
[E ProcessGroupGloo.cpp:138] [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 1800000 ms
Error executing job with overrides: ['experiment=tdex-run1']
Traceback (most recent call last):
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 82, in <module>
    main()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/main.py", line 94, in decorated_main
    _run_hydra(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 394, in _run_hydra
    _run_app(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 457, in _run_app
    run_and_report(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 223, in run_and_report
    raise ex
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 220, in run_and_report
    return func()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/utils.py", line 458, in <lambda>
    lambda: hydra.run(
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/_internal/hydra.py", line 132, in run
    _ = ret.return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 260, in return_value
    raise self._return_value
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/hydra/core/utils.py", line 186, in run_job
    ret.return_value = task_function(task_cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 78, in main
    train(fabric, cfg)
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/train.py", line 50, in train
    learner.save(cfg.checkpoint_dir, model_type='latest') # Always save the latest encoder
  File "/opt/hpcaas/.mounts/fs-0565f60d669b6a2d3/home/akashsharma02/projects/tactile-dexterity/tactile_dexterity/learners/byol.py", line 30, in save
    self.fabric.save(os.path.join(checkpoint_dir, f'byol_encoder_{model_type}.pt'), self.byol.state_dict())
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/lightning/fabric/fabric.py", line 744, in save
    self.barrier()
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/lightning/fabric/fabric.py", line 527, in barrier
    self._strategy.barrier(name=name)
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/lightning/fabric/strategies/ddp.py", line 151, in barrier
    torch.distributed.barrier(device_ids=self._determine_ddp_device_ids())
  File "/data/home/akashsharma02/miniforge3/envs/tactile_dexterity/lib/python3.9/site-packages/torch/distributed/distributed_c10d.py", line 3313, in barrier
    work = default_pg.barrier(opts=opts)
RuntimeError: [Rank 0]: Ranks 1, 2, 3 failed to pass monitoredBarrier in 1800000 ms
srun: error: a100-st-p4de24xlarge-705: task 2: Exited with exit code 1
srun: launch/slurm: _step_signal: Terminating StepId=74033.0
slurmstepd: error: *** STEP 74033.0 ON a100-st-p4de24xlarge-705 CANCELLED AT 2024-01-29T06:43:13 ***
srun: error: a100-st-p4de24xlarge-705: task 3: Exited with exit code 1
srun: error: a100-st-p4de24xlarge-705: task 1: Exited with exit code 1
srun: error: a100-st-p4de24xlarge-705: task 0: Terminated
srun: Force Terminated StepId=74033.0
